<div
  id="modal-audiencia"
  class="fixed inset-0 z-50 hidden items-center justify-center bg-gray-900/50 backdrop-blur-sm p-4"
>
  <div
    class="relative w-full max-w-4xl max-h-[90vh] flex flex-col bg-white rounded-lg shadow-2xl border-t-4 border-gob-oro animate-fade-in-down"
  >
    <div
      class="flex-none flex items-center justify-between p-4 border-b bg-gray-50 rounded-t-lg"
    >
      <h2
        class="text-xl font-bold text-gob-guinda font-headings"
        id="modal-audiencia-title"
      >
        Nueva Audiencia
      </h2>
      <button
        id="close-modal-audiencia"
        class="text-gray-400 hover:text-gray-900 rounded-lg text-sm w-8 h-8 inline-flex justify-center items-center transition-colors"
      >
        <i class="fas fa-times fa-lg"></i>
      </button>
    </div>

    <div class="flex-1 overflow-y-auto p-6 custom-scrollbar">
      <form id="form-audiencia">
        <input type="hidden" id="audiencia-id" />

        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
          <label class="block text-sm font-bold text-gob-guinda mb-2"
            >Seleccionar Expediente *</label
          >
          <div class="relative">
            <select
              id="asunto-selector-audiencia"
              required
              class="bg-white border border-blue-300 text-gray-900 text-sm rounded-lg block w-full p-2.5 focus:ring-gob-oro focus:border-gob-oro"
            >
              <option value="">Cargando asuntos...</option>
            </select>
            <div
              class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"
            >
              <i class="fas fa-chevron-down text-xs"></i>
            </div>
          </div>
        </div>

        <div
          class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6 bg-gray-50 p-4 rounded-lg border border-gray-200"
        >
          <div class="col-span-full mb-2 border-b border-gray-200 pb-2">
            <span
              class="text-xs font-bold text-gray-400 uppercase tracking-wider"
              >Datos del Expediente</span
            >
          </div>
          <div>
            <label class="block text-xs font-bold text-gob-gris mb-1"
              >No. Expediente</label
            >
            <input
              type="text"
              id="expediente-auto-audiencia"
              readonly
              class="bg-gray-100 border border-gray-300 text-gray-500 text-sm rounded block w-full p-2"
            />
          </div>
          <div>
            <label class="block text-xs font-bold text-gob-gris mb-1"
              >Materia</label
            >
            <input
              type="text"
              id="materia-auto-audiencia"
              readonly
              class="bg-gray-100 border border-gray-300 text-gray-500 text-sm rounded block w-full p-2"
            />
          </div>
          <div>
            <label class="block text-xs font-bold text-gob-gris mb-1"
              >Gerencia</label
            >
            <input
              type="text"
              id="gerencia-auto-audiencia"
              readonly
              class="bg-gray-100 border border-gray-300 text-gray-500 text-sm rounded block w-full p-2"
            />
          </div>
          <div>
            <label class="block text-xs font-bold text-gob-gris mb-1"
              >Abogado Resp.</label
            >
            <input
              type="text"
              id="abogado-auto-audiencia"
              readonly
              class="bg-gray-100 border border-gray-300 text-gray-500 text-sm rounded block w-full p-2"
            />
          </div>
          <div class="md:col-span-2 lg:col-span-1">
            <label class="block text-xs font-bold text-gob-gris mb-1"
              >Órgano Jurisdiccional</label
            >
            <input
              type="text"
              id="organo-auto-audiencia"
              readonly
              class="bg-gray-100 border border-gray-300 text-gray-500 text-sm rounded block w-full p-2"
            />
          </div>
          <div class="md:col-span-3">
            <label class="block text-xs font-bold text-gob-gris mb-1"
              >Partes Procesales</label
            >
            <input
              type="text"
              id="partes-auto-audiencia"
              readonly
              class="bg-gray-100 border border-gray-300 text-gray-500 text-sm rounded block w-full p-2"
            />
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
          <div class="md:col-span-2">
            <label class="block text-sm font-bold text-gob-gris mb-1"
              >Tipo de Audiencia *</label
            >
            <div class="flex gap-2">
              <select
                id="tipo-audiencia"
                required
                class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-gob-oro focus:border-gob-oro block w-full p-2.5"
              >
                <option value="">Seleccione...</option>
              </select>
              <button
                type="button"
                id="btn-manage-tipos"
                class="px-3 py-2 bg-gray-200 hover:bg-gray-300 text-gob-gris rounded-lg border border-gray-300"
                title="Administrar Tipos"
              >
                <i class="fas fa-cog"></i>
              </button>
            </div>
          </div>

          <div>
            <label class="block text-sm font-bold text-gob-gris mb-1"
              >Fecha *</label
            >
            <input
              type="date"
              id="fecha-audiencia"
              required
              class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-gob-oro focus:border-gob-oro block w-full p-2.5"
            />
          </div>

          <div>
            <label class="block text-sm font-bold text-gob-gris mb-1"
              >Hora *</label
            >
            <input
              type="time"
              id="hora-audiencia"
              required
              class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-gob-oro focus:border-gob-oro block w-full p-2.5"
            />
          </div>

          <div
            class="md:col-span-2 bg-gray-100 p-4 rounded-lg border border-gray-200"
          >
            <div
              class="flex items-center justify-between mb-3 border-b border-gray-300 pb-2"
            >
              <label class="text-sm font-bold text-gob-gris"
                >Ubicación (Presencial / En Línea)</label
              >

              <div
                class="inline-flex rounded-md shadow-sm"
                role="group"
                id="ubicacion-selector-group"
              >
                <input
                  type="radio"
                  name="ubicacion_tipo"
                  value="presencial"
                  id="radio-presencial"
                  checked
                  class="hidden peer/presencial"
                />
                <label
                  for="radio-presencial"
                  class="px-3 py-1.5 text-xs font-bold rounded-l-md border border-gray-300 cursor-pointer transition-colors peer-checked/presencial:bg-gob-guinda peer-checked/presencial:text-white peer-checked/presencial:border-gob-guinda"
                >
                  <i class="fas fa-building mr-1"></i> Presencial
                </label>

                <input
                  type="radio"
                  name="ubicacion_tipo"
                  value="en_linea"
                  id="radio-online"
                  class="hidden peer/online"
                />
                <label
                  for="radio-online"
                  class="px-3 py-1.5 text-xs font-bold rounded-r-md border border-gray-300 cursor-pointer transition-colors peer-checked/online:bg-gob-guinda peer-checked/online:text-white peer-checked/online:border-gob-guinda"
                >
                  <i class="fas fa-video mr-1"></i> En Línea
                </label>
              </div>
            </div>

            <div id="input-sala">
              <label class="block text-xs font-bold text-gob-gris mb-1"
                >Sala / Lugar (Presencial) *</label
              >
              <input
                type="text"
                id="sala-audiencia"
                class="bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-gob-oro focus:border-gob-oro block w-full p-2.5"
                placeholder="Ej. Sala 3 de Oralidad Penal"
              />
            </div>

            <div id="input-url" class="hidden">
              <label class="block text-xs font-bold text-gob-gris mb-1"
                >URL Reunión (En Línea) *</label
              >
              <input
                type="url"
                id="url-audiencia"
                class="bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-gob-oro focus:border-gob-oro block w-full p-2.5"
                placeholder="Ej. https://meet.google.com/xyz-abc"
              />
            </div>
          </div>
          <div class="md:col-span-2">
            <label class="block text-sm font-bold text-gob-gris mb-1"
              >Abogado que Comparece *</label
            >
            <select
              id="abogado-comparece"
              required
              class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-gob-oro focus:border-gob-oro block w-full p-2.5"
            >
              <option value="">Seleccione abogado...</option>
            </select>
          </div>
        </div>

        <div
          class="bg-blue-50 border border-blue-200 rounded-lg p-4 animate-fade-in-down"
        >
          <div
            class="flex items-center gap-2 mb-3 border-b border-blue-200 pb-2"
          >
            <i class="fas fa-bell text-gob-oro"></i>
            <p
              class="text-sm font-bold text-gob-guinda uppercase tracking-wide"
            >
              Configuración del Recordatorio Automático
            </p>
          </div>

          <div class="grid grid-cols-2 gap-4 mb-3">
            <div>
              <label class="block text-xs font-bold text-gray-500 mb-1"
                >Días antes</label
              >
              <input
                type="number"
                id="dias-antes-rec-aud"
                min="0"
                value="1"
                class="bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-gob-oro block w-full p-2.5"
              />
            </div>
            <div>
              <label class="block text-xs font-bold text-gray-500 mb-1"
                >Horas antes</label
              >
              <input
                type="number"
                id="horas-antes-rec-aud"
                min="0"
                value="2"
                class="bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-gob-oro block w-full p-2.5"
              />
            </div>
          </div>
          <div>
            <label class="block text-xs font-bold text-gob-gris mb-1"
              >Nota adicional</label
            >
            <input
              type="text"
              id="nota-rec-aud"
              class="bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-gob-oro block w-full p-2.5"
              placeholder="Ej: Preparar carpeta de investigación"
            />
          </div>
        </div>
      </form>
    </div>

    <div
      class="flex-none flex items-center justify-end p-4 border-t bg-gray-50 rounded-b-lg gap-3"
    >
      <button
        id="cancel-audiencia"
        class="text-gray-500 bg-white hover:bg-gray-100 border border-gray-300 font-medium rounded-lg text-sm px-5 py-2.5 transition-colors"
      >
        Cancelar
      </button>
      <button
        id="save-audiencia"
        class="text-white bg-gob-guinda hover:bg-gob-guindaDark font-bold rounded-lg text-sm px-5 py-2.5 shadow-md transition-colors flex items-center gap-2"
      >
        <i class="fas fa-save"></i> Guardar Audiencia
      </button>
    </div>
  </div>
</div>

<div
  id="modal-manage-tipos"
  class="fixed inset-0 z-[60] hidden items-center justify-center bg-gray-900/50 backdrop-blur-sm p-4"
>
  <div
    class="relative w-full max-w-md bg-white rounded-lg shadow-xl border-t-4 border-gray-600 animate-fade-in-down"
  >
    <div
      class="p-4 border-b bg-gray-50 rounded-t flex justify-between items-center"
    >
      <h3 class="font-bold text-gob-gris font-headings">
        Gestionar Tipos de Audiencia
      </h3>
      <button id="close-manage-tipos" class="text-gray-400 hover:text-gray-900">
        <i class="fas fa-times"></i>
      </button>
    </div>

    <div class="p-4">
      <div class="flex gap-2 mb-4">
        <input type="hidden" id="tipo-audiencia-edit-index" />
        <input
          type="text"
          id="input-nuevo-tipo"
          class="flex-1 bg-white border border-gray-300 rounded text-sm p-2 focus:ring-gob-oro"
          placeholder="Nombre del tipo..."
        />
        <button
          id="btn-save-tipo"
          class="bg-gob-guinda text-white px-3 py-2 rounded hover:bg-gob-guindaDark transition-colors"
        >
          <i class="fas fa-plus"></i>
        </button>
        <button
          id="btn-cancel-edit-tipo"
          class="hidden bg-gray-200 text-gray-600 px-3 py-2 rounded hover:bg-gray-300"
        >
          <i class="fas fa-times"></i>
        </button>
      </div>

      <div class="border rounded bg-gray-50 max-h-60 overflow-y-auto">
        <ul id="lista-tipos-audiencia" class="divide-y divide-gray-200"></ul>
      </div>
    </div>
  </div>
</div>

<div
  id="modal-finalizar-audiencia"
  class="fixed inset-0 z-50 hidden items-center justify-center bg-gray-900/50 backdrop-blur-sm p-4"
>
  <div
    class="relative w-full max-w-lg bg-white rounded-lg shadow-xl border-t-4 border-green-600 animate-fade-in-down"
  >
    <div
      class="p-4 border-b bg-green-50 rounded-t flex justify-between items-center"
    >
      <h2
        class="text-lg font-bold text-green-800 font-headings flex items-center gap-2"
      >
        <i class="fas fa-check-circle"></i> Concluir 
      </h2>
      <button
        id="close-modal-finalizar"
        class="text-green-800 hover:text-green-900 transition-colors"
      >
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="p-6">
      <input type="hidden" id="finalizar-audiencia-id" />
      <div class="bg-green-50 border-l-4 border-green-500 p-4 mb-4 rounded-r">
        <div class="flex items-start">
          <div class="flex-shrink-0">
            <i class="fas fa-file-upload text-green-600 mt-0.5"></i>
          </div>
          <div class="ml-3">
            <p class="text-sm text-green-800 font-bold">
              Acta documento de cierre registrado.
            </p>
            <p class="text-xs text-green-700 mt-1">
              Al confirmar, la audiencia se marcará como "Concluida" y se moverá
              a la Agenda General.
            </p>
          </div>
        </div>
      </div>
      <label class="block text-sm font-bold text-gob-gris mb-2"
        >Observaciones Finales *</label
      >
      <textarea
        id="observaciones-finales"
        rows="4"
        class="w-full p-3 border border-gray-300 rounded-lg text-sm"
        placeholder="Resultado..."
      ></textarea>
    </div>
    <div class="flex justify-end p-4 border-t gap-3 bg-gray-50 rounded-b-lg">
      <button
        id="cancel-finalizar"
        class="px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg text-sm"
      >
        Cancelar
      </button>
      <button
        id="confirmar-finalizar"
        class="px-4 py-2 bg-green-600 text-white rounded-lg text-sm font-bold shadow-md"
      >
        Confirmar
      </button>
    </div>
  </div>
</div>

<div
  id="modal-comentarios"
  class="fixed inset-0 z-50 hidden items-center justify-center bg-gray-900/50 backdrop-blur-sm p-4"
>
  <div
    class="bg-white w-full max-w-2xl rounded-lg shadow-xl h-[80vh] flex flex-col animate-fade-in-down border-t-4 border-gray-500"
  >
    <div
      class="p-4 border-b bg-gray-100 flex justify-between items-center rounded-t"
    >
      <h2 class="font-bold text-gob-gris text-lg">Comentarios</h2>
      <button id="close-modal-comentarios" class="text-gray-500">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="flex-1 p-4 overflow-y-auto bg-gray-50">
      <input type="hidden" id="comentarios-audiencia-id" />
      <ul id="lista-comentarios" class="space-y-3"></ul>
    </div>
    <div class="p-4 border-t bg-white rounded-b-lg">
      <div class="flex gap-2">
        <textarea
          id="nuevo-comentario"
          rows="2"
          class="flex-1 border border-gray-300 rounded-lg p-2 text-sm"
          placeholder="Escribe un comentario..."
        ></textarea>
        <button
          id="save-comentario"
          class="bg-gob-gris text-white px-4 py-2 rounded-lg"
        >
          <i class="fas fa-paper-plane"></i>
        </button>
      </div>
    </div>
  </div>
</div>

<div
  id="modal-confirmacion-audiencia"
  class="fixed inset-0 z-[60] hidden items-center justify-center bg-gray-900/60 backdrop-blur-sm p-4"
>
  <div
    class="relative w-full max-w-sm bg-white rounded-lg shadow-2xl border-t-4 border-yellow-500 animate-fade-in-down p-6 text-center"
  >
    <h3
      id="confirm-titulo-audiencia"
      class="mb-2 text-xl font-bold text-gob-gris"
    >
      Confirmar Acción
    </h3>
    <p id="confirm-mensaje-audiencia" class="text-sm text-gray-500 mb-6">
      ¿Estás seguro?
    </p>
    <div class="flex justify-center gap-3">
      <button
        id="btn-confirm-cancel-audiencia"
        class="px-4 py-2 border rounded"
      >
        Cancelar
      </button>
      <button
        id="btn-confirm-accept-audiencia"
        class="px-4 py-2 bg-gob-guinda text-white rounded font-bold"
      >
        Aceptar
      </button>
    </div>
  </div>
</div>

<div
  id="modal-alerta-audiencia"
  class="fixed inset-0 z-[80] hidden items-center justify-center bg-gray-900/60 backdrop-blur-sm p-4"
>
  <div
    class="relative w-full max-w-sm bg-white rounded-lg shadow-2xl border-t-4 border-blue-600 animate-fade-in-down p-6 text-center"
  >
    <h3 class="mb-2 text-xl font-bold text-gob-gris">Información</h3>
    <p id="alerta-mensaje-audiencia" class="text-sm text-gray-500 mb-6">
      Mensaje
    </p>
    <button
      id="btn-alerta-accept-audiencia"
      class="px-4 py-2 bg-blue-600 text-white rounded font-bold"
    >
      Entendido
    </button>
  </div>
</div>

<div
  id="modal-reasignar-audiencia"
  class="fixed inset-0 z-50 hidden items-center justify-center bg-gray-900/50 backdrop-blur-sm p-4"
>
  <div
    class="relative w-full max-w-md bg-white rounded-lg shadow-xl border-t-4 border-orange-500 animate-fade-in-down"
  >
    <div
      class="p-4 border-b bg-gray-50 rounded-t flex justify-between items-center"
    >
      <h3 class="font-bold text-gob-gris">Reasignar Audiencia</h3>
      <button id="close-modal-reasignar-audiencia" class="text-gray-400">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="p-6 space-y-4">
      <input type="hidden" id="reasignar-audiencia-id" />
      <div>
        <label class="block text-xs font-bold text-gray-500 uppercase"
          >Tipo</label
        ><input
          type="text"
          id="reasignar-tipo-audiencia"
          readonly
          class="w-full bg-gray-100 border p-2 rounded text-sm"
        />
      </div>
      <div>
        <label class="block text-xs font-bold text-gray-500 uppercase"
          >Abogado Actual</label
        ><input
          type="text"
          id="reasignar-abogado-actual-audiencia"
          readonly
          class="w-full bg-gray-100 border p-2 rounded text-sm"
        />
      </div>
      <div>
        <label class="block text-sm font-bold text-gob-guinda"
          >Nuevo Abogado</label
        ><select
          id="select-nuevo-abogado-audiencia"
          class="w-full border p-2 rounded text-sm"
        ></select>
      </div>
    </div>
    <div class="flex justify-end p-4 border-t gap-2 bg-gray-50 rounded-b">
      <button
        id="cancel-reasignar-audiencia"
        class="px-4 py-2 bg-white border rounded text-sm"
      >
        Cancelar
      </button>
      <button
        id="save-reasignar-audiencia"
        class="px-4 py-2 bg-orange-600 text-white rounded text-sm font-bold"
      >
        Reasignar
      </button>
    </div>
  </div>
</div>
